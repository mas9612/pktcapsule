package ipinip

import "testing"

var checksumTests = []struct {
	in  []byte
	out uint16
}{
	{
		[]byte{0x45, 0x00, 0x00, 0x73, 0x00, 0x00, 0x40, 0x00, 0x40, 0x11, 0x00, 0x00, 0xc0, 0xa8, 0x00, 0x01, 0xc0, 0xa8, 0x00, 0xc7},
		0xb861,
	},
	{
		[]byte{0x45, 0x00, 0x00, 0x3c, 0x1c, 0x46, 0x40, 0x00, 0x40, 0x06, 0x00, 0x00, 0xac, 0x10, 0x0a, 0x63, 0xac, 0x10, 0x0a, 0x0c},
		0xb1e6,
	},
}

func TestChecksum(t *testing.T) {
	for _, tt := range checksumTests {
		c := checksum(tt.in)
		if c != tt.out {
			t.Errorf("checksum(% x) = %d, but got %d\n", tt.in, tt.out, c)
		}
	}
}
